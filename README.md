<p align="left">
  <img width="90%" href="https://rasgoml.com" target="_blank" src="https://gblobscdn.gitbook.com/assets%2F-MJDKltt3A57jhixTfmu%2F-MJZZeY9BhUCtGPyz6bm%2F-MJZiXHTjQnyVWs6YGPc%2Frasgo-logo-full-color-rgb%20(4).png?alt=media&token=64e56b18-4282-4140-836b-e19c8e2787dc" />
</p>

[![PyPI version](https://badge.fury.io/py/rasgotransforms.svg)](https://badge.fury.io/py/rasgotransforms)
[![Docs](https://img.shields.io/badge/rasgotransforms-DOCS-GREEN.svg)](https://docs.rasgoml.com/rasgo-docs/transforms/overview)
[![Chat on Slack](https://img.shields.io/badge/chat-on%20Slack-brightgreen.svg)](https://join.slack.com/t/rasgousergroup/shared_invite/zt-nytkq6np-ANEJvbUSbT2Gkvc8JICp3g)
[![Chat on Discourse](https://img.shields.io/discourse/status?server=https%3A%2F%2Fforum.rasgoml.com)](https://forum.rasgoml.com/)

# Rasgo Transforms

Rasgo Transforms is a library of SQL templates that can be called like functions. They use jinja for templating and are compatible with multiple Rasgo tools:
- [RasgoQL](https://github.com/rasgointelligence/RasgoQL), an open source python package to transform data in SQL
- [PyRasgo](https://pypi.org/project/pyrasgo/), a python library for interacting with Rasgo
- [Rasgo SQL Generator](https://app.rasgoml.com/sql), a browser tool for generating SQL via a user interface
- [Rasgo](https://rasgoml.com), our enterprise self-service analytics product

# Writing Transforms

Transforms are SQL templates that are rendered using arguments that we define in a config `.yaml.` file. To add a transform, you must include the jinja template file which produces the SQL, the config yaml file which defines the arguments needed for the template to render, and optionally, a python file with the `infer_columns` function implemented which is used to infer the columns their types of a table created from a transform's sql query.

The new transform should be added to the projects file structure like this:

```
rasgotransforms/rasgotransforms/transforms/
    <transform name>/
        <data warehouse type (optional)>/
            <transform name>.sql
            <transform name>.yaml
        <transform name>.sql
        <transform name>.yaml
        <transform name>.py
```

If the sql for a template needs to render differently for specific data warehouse types, then additional template and config definitions can be added under a data warehouse specific directory (e.g. 'snowflake')

# Inferring Columns

RasgoTransforms has the ability to infer the column names and data types from a SQL query generated by one of the templates using the `infer_columns` function.

To enable column inference for a transform, the python file for the transform must contain a python function which takes the arguments and source columns and returns a dictionary mapping the column names to their types. The required structure is like this:

```python
def infer_columns(args, source_columns) -> dict:
    out_columns = source_columns.copy()
    # Logic which determines columns output from the query...
    out_columns['new_column'] = 'new_column_type'
    return out_columns
```

# About Us
Rasgo Transforms are maintained by *[Rasgo](https://rasgoml.com)*.
