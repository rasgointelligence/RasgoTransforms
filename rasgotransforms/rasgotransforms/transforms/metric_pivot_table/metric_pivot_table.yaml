name: metric_pivot_table
tags:
  - table
  - reshape
  - math
  - aggregate
description: |
  ## Pivot table for metrics, powered by SQL.

  ### Required Inputs
  - Metrics: a dictionary of the metric values you want to aggregate

  ### Optional Inputs
  - Rows: column(s) to group by down
  - Columns: column(s) to pivot across
  - Filters: filters to apply

  ### Notes
  - Applies a hard limit of 500 distinct values in the 'columns' column

arguments:
  metrics:
    type: comparison_list
    description: columns to aggregate
  rows:
    type: dimension_list
    description: Dimensions to group by (column values will become rows)
    is_optional: true
  columns:
    type: dimension_list
    description: Dimensions with row values that will become columns
    is_optional: true
  filters:
    type: filter_list
    description: Filters to apply to the table
    is_optional: true
example_code: |
  ds2 = ds.pivot_table(
    rows=['DATE'],
    metrics=[
      {'resource_key': 'MAX_OPEN_PRICE'},
      {'resource_key': 'MIN_CLOSE_PRICE'}
    ],
    columns='SYMBOL',
  )
  ds2.preview()