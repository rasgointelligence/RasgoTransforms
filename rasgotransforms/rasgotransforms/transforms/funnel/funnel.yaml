name: funnel
type: insight
context:
  chart_type: sankey
tags:
description: Analyze the hierarchical record count of a series of columns by counting the number of records in each pair of values in hierarchically adjacent columns.
arguments:
  hierarchy:
    type: column_list
    description: Ordered list of columns, from highest in hierarchy to lowest
example_code: |
  ds = rasgo.get.dataset(id)

  ds2 = ds.funnel(hierarchy=["ENGLISHCOUNTRYREGIONNAME", "STATEPROVINCENAME", "CITY"])
  ds2.preview()
